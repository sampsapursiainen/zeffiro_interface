function zef = ias_map_estimation_window(zef)


h1 = figure(...
'PaperUnits',get(0,'defaultfigurePaperUnits'),...
'Units','normalized',...
'Position',[0.432638888888889 0.52 0.241666666666667 0.505555555555556],...
'Visible',get(0,'defaultfigureVisible'),...
'Color',get(0,'defaultfigureColor'),...
'IntegerHandle','off',...
'Colormap',[0 0 0.5625;0 0 0.625;0 0 0.6875;0 0 0.75;0 0 0.8125;0 0 0.875;0 0 0.9375;0 0 1;0 0.0625 1;0 0.125 1;0 0.1875 1;0 0.25 1;0 0.3125 1;0 0.375 1;0 0.4375 1;0 0.5 1;0 0.5625 1;0 0.625 1;0 0.6875 1;0 0.75 1;0 0.8125 1;0 0.875 1;0 0.9375 1;0 1 1;0.0625 1 1;0.125 1 0.9375;0.1875 1 0.875;0.25 1 0.8125;0.3125 1 0.75;0.375 1 0.6875;0.4375 1 0.625;0.5 1 0.5625;0.5625 1 0.5;0.625 1 0.4375;0.6875 1 0.375;0.75 1 0.3125;0.8125 1 0.25;0.875 1 0.1875;0.9375 1 0.125;1 1 0.0625;1 1 0;1 0.9375 0;1 0.875 0;1 0.8125 0;1 0.75 0;1 0.6875 0;1 0.625 0;1 0.5625 0;1 0.5 0;1 0.4375 0;1 0.375 0;1 0.3125 0;1 0.25 0;1 0.1875 0;1 0.125 0;1 0.0625 0;1 0 0;0.9375 0 0;0.875 0 0;0.8125 0 0;0.75 0 0;0.6875 0 0;0.625 0 0;0.5625 0 0],...
'MenuBar','none',...
'ToolBar','none',...
'Name','IAS MAP estimation',...
'NumberTitle','off',...
'HandleVisibility','off',...
'Tag','figure1',...
'UserData',[],...
'Resize',get(0,'defaultfigureResize'),...
'PaperPosition',get(0,'defaultfigurePaperPosition'),...
'PaperSize',[20.99999864 29.69999902],...
'PaperType',get(0,'defaultfigurePaperType'),...
'InvertHardcopy',get(0,'defaultfigureInvertHardcopy'),...
'ScreenPixelsPerInchMode','manual',...
'CreateFcn', '' );

zef.h_ias_map_estimation = h1;

h2 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','Hyperprior:',...
'Style','text',...
'Position',[0.0348311365552745 0.96 0.475482378930655 0.0446621923937361],...
'Children',[],...
'Tag','text2',...
'UserData',[],...
'FontSize',0.44324942791762,...
'CreateFcn', '');


h3 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'String',{  'Spatially balanced'; 'Spatially constant' },...
'Style','popupmenu',...
'Value',1,...
'Position',[0.572410094823888 0.96 0.408063235649443 0.0497664429530199],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_hyperprior = get(gcbo,''Value'');',...
'Children',[],...
'CreateFcn', '',...
'Tag','popupmenu2',...
'UserData',[],...
'FontSize',0.397787948131197);

zef.h_ias_hyperprior = h3;

%************************************************
h2b = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','Standardization:',...
'Style','text',...
'Position',[0.0348311365552745 0.90 0.475482378930655 0.0446621923937361],...
'Children',[],...
'Tag','text2',...
'UserData',[],...
'FontSize',0.44324942791762,...
'CreateFcn', '');


h3b = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'String',{  'None'; 'sLORETA each step'; 'sLORETA last step';'dSPM each step';'dSPM last step'},...
'Style','popupmenu',...
'Value',1,...
'Position',[0.572410094823888 0.90 0.408063235649443 0.0497664429530199],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_type = get(gcbo,''Value'');',...
'Children',[],...
'CreateFcn', '',...
'Tag','popupmenu2',...
'UserData',[],...
'FontSize',0.397787948131197);

zef.h_ias_type = h3b;


%*******************************************


h4 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','IAS MAP iterations:',...
'Style','text',...
'Position',[0.0348311365552745 0.761023415361675 0.475482378930655 0.0446621923937361],...
'Children',[],...
'Tag','text6',...
'UserData',[],...
'FontSize',0.44324942791762,...
'CreateFcn', '' );


h5 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'String','25',...
'Style','edit',...
'Value',1,...
'Position',[0.790635216497286 0.757833258762123 0.180967174070622 0.04976644295302],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_n_map_iterations = str2num(get(gcbo,''string''));',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','edit3',...
'FontSize',0.397787948131197);

zef.h_ias_n_map_iterations = h5;

h6 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','Sampling frequency (Hz):',...
'Style','text',...
'Position',[0.0348311365552745 0.684459656972414 0.475482378930655 0.0446621923937361],...
'Children',[],...
'Tag','text10',...
'UserData',[],...
'FontSize',0.44324942791762,...
'CreateFcn', '' );

h7 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'String','1025',...
'Style','edit',...
'Value',1,...
'Position',[0.790635216497286 0.681269500372861 0.180967174070622 0.04976644295302],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_sampling_frequency = str2num(get(gcbo,''string''));',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','edit6',...
'FontSize',0.397787948131197);

zef.h_ias_sampling_frequency = h7;

h8 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','Low-cut frequency (Hz):',...
'Style','text',...
'Position',[0.0348311365552745 0.607895898583153 0.475482378930655 0.0446621923937361],...
'Children',[],...
'Tag','text11',...
'UserData',[],...
'FontSize',0.44324942791762,...
'CreateFcn', '' );

h9 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'String','7',...
'Style','edit',...
'Value',1,...
'Position',[0.790635216497286 0.604705741983601 0.180967174070622 0.04976644295302],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_low_cut_frequency = str2num(get(gcbo,''string''));',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','edit7',...
'FontSize',0.397787948131198);

zef.h_ias_low_cut_frequency = h9;

h10 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','High-cut frequency (Hz):',...
'Style','text',...
'Position',[0.0348311365552745 0.53133214019389 0.475482378930655 0.044662192393736],...
'Children',[],...
'Tag','text12',...
'UserData',[],...
'FontSize',0.443249427917621,...
'CreateFcn', '' );

h11 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'String','9',...
'Style','edit',...
'Value',1,...
'Position',[0.790635216497286 0.528141983594337 0.180967174070622 0.04976644295302],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_high_cut_frequency = str2num(get(gcbo,''string''));',...
'Children',[],...
'CreateFcn', '',...
'Tag','edit8',...
'FontSize',0.397787948131197);

zef.h_ias_high_cut_frequency = h11;

h12 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Start',...
'Position',[0.799025551529964 0.04 0.172851888067813 0.0705351159964065],...
'Callback','zef_update_ias; zef.reconstruction = ias_iteration(zef);',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','pushbutton12',...
'FontSize',0.280661496737012);

zef.h_ias_start = h12;

h13 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Close',...
'Position',[0.431161276924106 0.04 0.172851888067813 0.0705351159964065],...
'Callback','close(zef.h_ias_map_estimation);',...
'Children',[],...
'CreateFcn','',...
'Tag','pushbutton13',...
'FontSize',0.280661496737012);

zef.h_ias_cancel = h13;

h14 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','Number of time steps:',...
'Style','text',...
'Position',[0.0348311365552745 0.301640865026107 0.475482378930655 0.0446621923937359],...
'Children',[],...
'Tag','text19',...
'UserData',[],...
'FontSize',0.443249427917622,...
'CreateFcn', '' );

h15 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'String','1',...
'Style','edit',...
'Value',1,...
'Position',[0.790635216497286 0.29845070842655 0.180967174070622 0.0497664429530201],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_number_of_frames = str2num(get(gcbo,''string''));',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','edit10',...
'FontSize',0.397787948131197);

zef.h_ias_number_of_frames = h15;

h16 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','Signal-to-noise ratio:',...
'Style','text',...
'Position',[0.0348311365552745 0.834397017151383 0.475482378930655 0.0446621923937361],...
'Children',[],...
'Tag','text20',...
'UserData',[],...
'FontSize',0.44324942791762,...
'CreateFcn','' );

h17 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'String','0.05',...
'Style','edit',...
'Value',1,...
'Position',[0.790635216497286 0.831206860551831 0.180967174070622 0.04976644295302],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_snr = str2num(get(gcbo,''string''));',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','edit11',...
'FontSize',0.397787948131199);

zef.h_ias_snr = h17;

h18 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'String','Apply',...
'Position',[0.615128232666164 0.04 0.172851888067813 0.0705351159964065],...
'Callback','zef_update_ias;',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','pushbutton14',...
'FontSize',0.280661496737012);

zef.h_ias_apply = h18;

h19 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','Data normalization:',...
'Style','text',...
'Position',[0.0348311365552745 0.148235943325879 0.475482378930655 0.0446621923937361],...
'Children',[],...
'Tag','text25',...
'UserData',[],...
'FontSize',0.44324942791762,...
'CreateFcn', '' );


h20 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'String',{  'Maximum entry'; 'Maximum column norm'; 'Average column norm'; 'None' },...
'Style','popupmenu',...
'Value',1,...
'Position',[0.572410094823888 0.138665473527221 0.408063235649443 0.0497664429530201],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_normalize_data = get(gcbo,''value'');',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','popupmenu8',...
'UserData',[],...
'FontSize',0.397787948131197);

zef.h_ias_normalize_data = h20;

h21 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','Time interval start (s):',...
'Style','text',...
'Position',[0.0348311365552745 0.454768381804627 0.475482378930655 0.044662192393736],...
'Children',[],...
'Tag','text26',...
'UserData',[],...
'FontSize',0.44324942791762,...
'CreateFcn','');

h22 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'String','0',...
'Style','edit',...
'Value',1,...
'Position',[0.790635216497286 0.451578225205075 0.180967174070622 0.0497664429530202],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_time_1 = str2num(get(gcbo,''string''));',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','edit14',...
'FontSize',0.397787948131197);

zef.h_ias_time_1 = h22;

h23 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','Time window (s):',...
'Style','text',...
'Position',[0.0348311365552745 0.378204623415366 0.475482378930655 0.044662192393736],...
'Children',[],...
'Tag','text27',...
'UserData',[],...
'FontSize',0.44324942791762,...
'CreateFcn', '' );

h24 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'String','0',...
'Style','edit',...
'Value',1,...
'Position',[0.790635216497286 0.375014466815812 0.180967174070622 0.0497664429530201],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_time_2 = str2num(get(gcbo,''string''));',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','edit15',...
'FontSize',0.397787948131197);

zef.h_ias_time_2= h24;

h25 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','left',...
'ListboxTop',0,...
'String','Time step (s):',...
'Style','text',...
'Position',[0.0348311365552743 0.225077106636842 0.475482378930655 0.044662192393736],...
'Children',[],...
'Tag','text31',...
'UserData',[],...
'FontSize',0.44324942791762,...
'CreateFcn', '');

h26 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'FontUnits','normalized',...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'String','0',...
'Style','edit',...
'Value',1,...
'Position',[0.790635216497287 0.221886950037289 0.180967174070622 0.0497664429530201],...
'BackgroundColor',[1 1 1],...
'Callback','zef.ias_time_3 = str2num(get(gcbo,''string''));',...
'Children',[],...
'CreateFcn', '' ,...
'Tag','edit19',...
'FontSize',0.397787948131197);

zef.h_ias_time_3= h26;

for i = 1 : length(h1.Children)
h1.Children(i).Position(2) = h1.Children(i).Position(2) - 0.03;
end

end