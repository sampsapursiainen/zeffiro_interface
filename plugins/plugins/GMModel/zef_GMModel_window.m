function zef = zef_GMModel_window(zef)


h1 = figure(...
    'PaperUnits',get(0,'defaultfigurePaperUnits'),...
    'Units','normalized',...
    'Position',[0.43 0.52 0.20 0.45],...
    'Visible',get(0,'defaultfigureVisible'),...
    'Color',get(0,'defaultfigureColor'),...
    'IntegerHandle','off',...
    'Colormap',[0 0 0.5625;0 0 0.625;0 0 0.6875;0 0 0.75;0 0 0.8125;0 0 0.875;0 0 0.9375;0 0 1;0 0.0625 1;0 0.125 1;0 0.1875 1;0 0.25 1;0 0.3125 1;0 0.375 1;0 0.4375 1;0 0.5 1;0 0.5625 1;0 0.625 1;0 0.6875 1;0 0.75 1;0 0.8125 1;0 0.875 1;0 0.9375 1;0 1 1;0.0625 1 1;0.125 1 0.9375;0.1875 1 0.875;0.25 1 0.8125;0.3125 1 0.75;0.375 1 0.6875;0.4375 1 0.625;0.5 1 0.5625;0.5625 1 0.5;0.625 1 0.4375;0.6875 1 0.375;0.75 1 0.3125;0.8125 1 0.25;0.875 1 0.1875;0.9375 1 0.125;1 1 0.0625;1 1 0;1 0.9375 0;1 0.875 0;1 0.8125 0;1 0.75 0;1 0.6875 0;1 0.625 0;1 0.5625 0;1 0.5 0;1 0.4375 0;1 0.375 0;1 0.3125 0;1 0.25 0;1 0.1875 0;1 0.125 0;1 0.0625 0;1 0 0;0.9375 0 0;0.875 0 0;0.8125 0 0;0.75 0 0;0.6875 0 0;0.625 0 0;0.5625 0 0],...
    'MenuBar','none',...
    'ToolBar','none',...
    'Name','ZEFFIRO Interface: Gaussian Mixture Model tool',...
    'NumberTitle','off',...
    'HandleVisibility','off',...
    'Tag','figure1',...
    'UserData',[],...
    'Resize',get(0,'defaultfigureResize'),...
    'PaperPosition',get(0,'defaultfigurePaperPosition'),...
    'PaperSize',[20.99999864 29.69999902],...
    'PaperType',get(0,'defaultfigurePaperType'),...
    'InvertHardcopy',get(0,'defaultfigureInvertHardcopy'),...
    'ScreenPixelsPerInchMode','manual',...
    'CreateFcn', '' );

zef.GMModel.h_window = h1;

h2 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','left',...
    'ListboxTop',0,...
    'String','Maximum number of clusters:',...
    'Style','text',...
    'Position',[0.05 0.88 0.5 0.07],...
    'Children',[],...
    'Tag','text1',...
    'UserData',[],...
    'FontSize',0.44324942791762,...
    'CreateFcn', '' );

h3 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','right',...
    'ListboxTop',0,...
    'String','20',...
    'Style','edit',...
    'Value',1,...
    'Position',[0.8 0.88 0.15 0.07],...
    'BackgroundColor',[1 1 1],...
    'Callback','zef.GMModel.max_n_clusters = str2num(get(gcbo,''string''));',...
    'Children',[],...
    'CreateFcn', '' ,...
    'Tag','edit3',...
    'FontSize',0.397787948131197);

zef.GMModel.h_max_n_clusters = h3;

h4 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','left',...
    'ListboxTop',0,...
    'String','Credibility (relative):',...
    'Style','text',...
    'Position',[0.05 0.77 0.5 0.07],...
    'Children',[],...
    'Tag','text10',...
    'UserData',[],...
    'FontSize',0.44324942791762,...
    'CreateFcn', '' );

h5 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','right',...
    'ListboxTop',0,...
    'String','0.95',...
    'Style','edit',...
    'Value',1,...
    'Position',[0.8 0.77 0.15 0.07],...
    'BackgroundColor',[1 1 1],...
    'Callback','zef.GMModel.credibility = str2num(get(gcbo,''string''));',...
    'Children',[],...
    'CreateFcn', '' ,...
    'Tag','edit6',...
    'FontSize',0.397787948131197);

zef.GMModel.h_credibility = h5;

h6 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','left',...
    'ListboxTop',0,...
    'String','Dynamic levels:',...
    'Style','text',...
    'Position',[0.05 0.66 0.5 0.07],...
    'Children',[],...
    'Tag','text11',...
    'UserData',[],...
    'FontSize',0.44324942791762,...
    'CreateFcn', '' );

h7 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','right',...
    'ListboxTop',0,...
    'String','4',...
    'Style','edit',...
    'Value',1,...
    'Position',[0.8 0.66 0.15 0.07],...
    'BackgroundColor',[1 1 1],...
    'Callback','zef.GMModel.n_dynamic_levels = str2num(get(gcbo,''string''));',...
    'Children',[],...
    'CreateFcn', '' ,...
    'Tag','edit7',...
    'FontSize',0.397787948131198);

zef.GMModel.h_n_dynamic_levels = h7;

h8 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','left',...
    'ListboxTop',0,...
    'String','Regularization parameter:',...
    'Style','text',...
    'Position',[0.05 0.55 0.5 0.07],...
    'Children',[],...
    'Tag','text12',...
    'UserData',[],...
    'FontSize',0.443249427917621,...
    'CreateFcn', '' );

h9 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','right',...
    'ListboxTop',0,...
    'String','1E-5',...
    'Style','edit',...
    'Value',1,...
    'Position',[0.8 0.55 0.15 0.07],...
    'BackgroundColor',[1 1 1],...
    'Callback','zef.GMModel.reg_param = str2num(get(gcbo,''string''));',...
    'Children',[],...
    'CreateFcn', '',...
    'Tag','edit8',...
    'FontSize',0.397787948131197);

zef.GMModel.h_reg_param = h9;

h10 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','left',...
    'ListboxTop',0,...
    'String','Maximum number of iterations:',...
    'Style','text',...
    'Position',[0.05 0.44 0.5 0.07],...
    'Children',[],...
    'Tag','text19',...
    'UserData',[],...
    'FontSize',0.443249427917622,...
    'CreateFcn', '' );

h11 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','right',...
    'ListboxTop',0,...
    'String','1000',...
    'Style','edit',...
    'Value',1,...
    'Position',[0.8 0.44 0.15 0.07],...
    'BackgroundColor',[1 1 1],...
    'Callback','zef.GMModel.max_n_iter = str2num(get(gcbo,''string''));',...
    'Children',[],...
    'CreateFcn', '' ,...
    'Tag','edit10',...
    'FontSize',0.397787948131197);

zef.GMModel.h_max_n_iter = h11;

h12 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','left',...
    'ListboxTop',0,...
    'String','Tolerance:',...
    'Style','text',...
    'Position',[0.05 0.33 0.5 0.07],...
    'Children',[],...
    'Tag','text20',...
    'UserData',[],...
    'FontSize',0.44324942791762,...
    'CreateFcn','' );

h13 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','right',...
    'ListboxTop',0,...
    'String','1E-3',...
    'Style','edit',...
    'Value',1,...
    'Position',[0.8 0.33 0.15 0.07],...
    'BackgroundColor',[1 1 1],...
    'Callback','zef.GMModel.tol_val = str2num(get(gcbo,''string''));',...
    'Children',[],...
    'CreateFcn', '' ,...
    'Tag','edit11',...
    'FontSize',0.397787948131199);

zef.GMModel.h_tol_val = h13;

h13 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','left',...
    'ListboxTop',0,...
    'String','Frame number:',...
    'Style','text',...
    'Position',[0.05 0.22 0.5 0.07],...
    'Children',[],...
    'Tag','text1',...
    'UserData',[],...
    'FontSize',0.44324942791762,...
    'CreateFcn', '' );

h14 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'HorizontalAlignment','right',...
    'ListboxTop',0,...
    'String','1',...
    'Style','edit',...
    'Value',1,...
    'Position',[0.8 0.22 0.15 0.07],...
    'BackgroundColor',[1 1 1],...
    'Callback','zef.GMModel.frame_number = str2num(get(gcbo,''string''));',...
    'Children',[],...
    'CreateFcn', '' ,...
    'Tag','edit3',...
    'FontSize',0.397787948131197);

zef.GMModel.h_frame_number = h14;

for i = 1 : length(h1.Children)
    h1.Children(i).Position(2) = h1.Children(i).Position(2) - 0.02;
end

%*******************************************

h15 = uicontrol(...
    'Parent',h1,...
    'Units','normalized',...
    'FontUnits','normalized',...
    'String','Run',...
    'Position',[0.8 0.03 0.15 0.1],...
    'Callback','zef = zef_GMModel_update(zef); [zef.GMModel.cluster_centres,zef.GMModel.dipole_moments,~,zef.GMModel.Param] = zef_cluster_reconstruction(zef);',...
    'Children',[],...
    'CreateFcn', '' ,...
    'Tag','pushbutton12',...
    'FontSize',0.280661496737012);

zef.GMModel.h_start = h15;

%*******************************************




end
